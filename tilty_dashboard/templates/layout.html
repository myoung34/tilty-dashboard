{% extends "bootstrap/base.html" %}

{% block head %}
{{ super() }}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css" />
    <script src="//bernii.github.io/gauge.js/dist/gauge.min.js"></script>
    <script src="//code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.js" integrity="sha256-yr4fRk/GU1ehYJPAs8P4JlTgu0Hdsp4ZKrx8bDEDC3I=" crossorigin="anonymous"></script>
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
    <style>
      body { background-color:#555888; font-family:sans-serif; text-align:center; margin-right: 15px; }
      code { display:inline-block; max-width:600px;  padding:80px 0 0; line-height:1.5; font-family:monospace; color:#ccc }
      #footer {
      	width: 960px;
      	height: 50px;
      	margin: 0 auto;
      	padding: 0px 0 15px 0;
      	border-top: 1px solid #292929;
      }
      #footer p {
      	margin: 0;
      	padding-top: 20px;
      	line-height: normal;
      	text-transform: uppercase;
      	text-align: center;
      	color: #444444;
        margin-top: -50px;
      }
      #footer a {
      	color: #444444;
      }
      .preview-textfield{
        position: relative;
        top: -165px;
        left: 0;
        right: 0;
      }
      .preview-datafield{
        position: relative;
        top: -75px;
        left: 0;
        right: 0;
        font-size: 1.8em;
        font-color: black;
      }
      .canvas {
        display: inline-block;
      }
      .container {
        width: 100%;
      }
      h1 {
        margin-top: 20px;
        margin-bottom: 30px;
      }
      .nav .open > a,
      .nav .open > a:hover,
      .nav .open > a:focus {background-color: transparent;}

      /*-------------------------------*/
      /*           Wrappers            */
      /*-------------------------------*/

      #wrapper {
          padding-left: 0;
          -webkit-transition: all 0.5s ease;
          -moz-transition: all 0.5s ease;
          -o-transition: all 0.5s ease;
          transition: all 0.5s ease;
      }

      #wrapper.toggled {
          padding-left: 220px;
      }

      #sidebar-wrapper {
          z-index: 1000;
          left: 220px;
          width: 0;
          height: 100%;
          margin-left: -220px;
          overflow-y: auto;
          overflow-x: hidden;
          background: #1a1a1a;
          -webkit-transition: all 0.5s ease;
          -moz-transition: all 0.5s ease;
          -o-transition: all 0.5s ease;
          transition: all 0.5s ease;
      }

      #sidebar-wrapper::-webkit-scrollbar {
        display: none;
      }

      #wrapper.toggled #sidebar-wrapper {
          width: 220px;
      }

      #page-content-wrapper {
          width: 100%;
          padding-top: 70px;
      }

      #wrapper.toggled #page-content-wrapper {
          position: absolute;
          margin-right: -220px;
      }

      /*-------------------------------*/
      /*     Sidebar nav styles        */
      /*-------------------------------*/

      .sidebar-nav {
          position: absolute;
          top: 0;
          width: 220px;
          margin: 0;
          padding: 0;
          list-style: none;
      }

      .sidebar-nav li {
          position: relative;
          line-height: 20px;
          display: inline-block;
          width: 100%;
      }

      .sidebar-nav li:before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          z-index: -1;
          height: 100%;
          width: 3px;
          background-color: #1c1c1c;
          -webkit-transition: width .2s ease-in;
            -moz-transition:  width .2s ease-in;
             -ms-transition:  width .2s ease-in;
                  transition: width .2s ease-in;

      }
      .sidebar-nav li:first-child a {
          color: #fff;
          background-color: #1a1a1a;
      }
      .sidebar-nav li:nth-child(2):before {
          background-color: #ec1b5a;
      }
      .sidebar-nav li:nth-child(3):before {
          background-color: #79aefe;
      }
      .sidebar-nav li:nth-child(4):before {
          background-color: #314190;
      }
      .sidebar-nav li:nth-child(5):before {
          background-color: #279636;
      }
      .sidebar-nav li:nth-child(6):before {
          background-color: #7d5d81;
      }
      .sidebar-nav li:nth-child(7):before {
          background-color: #ead24c;
      }
      .sidebar-nav li:nth-child(8):before {
          background-color: #2d2366;
      }
      .sidebar-nav li:nth-child(9):before {
          background-color: #35acdf;
      }
      .sidebar-nav li:hover:before,
      .sidebar-nav li.open:hover:before {
          width: 100%;
          -webkit-transition: width .2s ease-in;
            -moz-transition:  width .2s ease-in;
             -ms-transition:  width .2s ease-in;
                  transition: width .2s ease-in;

      }

      .sidebar-nav li a {
          display: block;
          color: #ddd;
          text-decoration: none;
          padding: 10px 15px 10px 30px;
      }

      .sidebar-nav li a:hover,
      .sidebar-nav li a:active,
      .sidebar-nav li a:focus,
      .sidebar-nav li.open a:hover,
      .sidebar-nav li.open a:active,
      .sidebar-nav li.open a:focus{
          color: #fff;
          text-decoration: none;
          background-color: transparent;
      }

      .sidebar-nav > .sidebar-brand {
          height: 65px;
          font-size: 20px;
          line-height: 44px;
      }
      .sidebar-nav .dropdown-menu {
          position: relative;
          width: 100%;
          padding: 0;
          margin: 0;
          border-radius: 0;
          border: none;
          background-color: #222;
          box-shadow: none;
      }

      /*-------------------------------*/
      /*       Hamburger-Cross         */
      /*-------------------------------*/

      .hamburger {
        position: fixed;
        top: 20px;
        z-index: 999;
        display: block;
        width: 32px;
        height: 32px;
        margin-left: 15px;
        background: transparent;
        border: none;
      }
      .hamburger:hover,
      .hamburger:focus,
      .hamburger:active {
        outline: none;
      }
      .hamburger.is-closed:before {
        content: '';
        display: block;
        width: 100px;
        font-size: 14px;
        color: #fff;
        line-height: 32px;
        text-align: center;
        opacity: 0;
        -webkit-transform: translate3d(0,0,0);
        -webkit-transition: all .35s ease-in-out;
      }
      .hamburger.is-closed:hover:before {
        opacity: 1;
        display: block;
        -webkit-transform: translate3d(-100px,0,0);
        -webkit-transition: all .35s ease-in-out;
      }

      .hamburger.is-closed .hamb-top,
      .hamburger.is-closed .hamb-middle,
      .hamburger.is-closed .hamb-bottom,
      .hamburger.is-open .hamb-top,
      .hamburger.is-open .hamb-middle,
      .hamburger.is-open .hamb-bottom {
        position: absolute;
        left: 0;
        height: 4px;
        width: 100%;
      }
      .hamburger.is-closed .hamb-top,
      .hamburger.is-closed .hamb-middle,
      .hamburger.is-closed .hamb-bottom {
        background-color: #1a1a1a;
      }
      .hamburger.is-closed .hamb-top {
        top: 5px;
        -webkit-transition: all .35s ease-in-out;
      }
      .hamburger.is-closed .hamb-middle {
        top: 50%;
        margin-top: -2px;
      }
      .hamburger.is-closed .hamb-bottom {
        bottom: 5px;
        -webkit-transition: all .35s ease-in-out;
      }

      .hamburger.is-closed:hover .hamb-top {
        top: 0;
        -webkit-transition: all .35s ease-in-out;
      }
      .hamburger.is-closed:hover .hamb-bottom {
        bottom: 0;
        -webkit-transition: all .35s ease-in-out;
      }
      .hamburger.is-open .hamb-top,
      .hamburger.is-open .hamb-middle,
      .hamburger.is-open .hamb-bottom {
        background-color: #1a1a1a;
      }
      .hamburger.is-open .hamb-top,
      .hamburger.is-open .hamb-bottom {
        top: 50%;
        margin-top: -2px;
      }
      .hamburger.is-open .hamb-top {
        -webkit-transform: rotate(45deg);
        -webkit-transition: -webkit-transform .2s cubic-bezier(.73,1,.28,.08);
      }
      .hamburger.is-open .hamb-middle { display: none; }
      .hamburger.is-open .hamb-bottom {
        -webkit-transform: rotate(-45deg);
        -webkit-transition: -webkit-transform .2s cubic-bezier(.73,1,.28,.08);
      }
      .hamburger.is-open:before {
        content: '';
        display: block;
        width: 100px;
        font-size: 14px;
        color: #fff;
        line-height: 32px;
        text-align: center;
        opacity: 0;
        -webkit-transform: translate3d(0,0,0);
        -webkit-transition: all .35s ease-in-out;
      }
      .hamburger.is-open:hover:before {
        opacity: 1;
        display: block;
        -webkit-transform: translate3d(-100px,0,0);
        -webkit-transition: all .35s ease-in-out;
      }

      /*-------------------------------*/
      /*            Overlay            */
      /*-------------------------------*/

      .overlay {
          position: fixed;
          display: none;
          width: 100%;
          height: 100%;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background-color: rgba(250,250,250,.8);
          z-index: 1;
      }
    </style>

    <script type="text/javascript" charset="utf-8">
      $(document).ready(function () {
        var trigger = $('.hamburger'),
            overlay = $('.overlay'),
           isClosed = false;

          trigger.click(function () {
            hamburger_cross();
          });

          function hamburger_cross() {

            if (isClosed == true) {
              overlay.hide();
              trigger.removeClass('is-open');
              trigger.addClass('is-closed');
              isClosed = false;
            } else {
              overlay.show();
              trigger.removeClass('is-closed');
              trigger.addClass('is-open');
              isClosed = true;
            }
        }

        $('[data-toggle="offcanvas"]').click(function () {
              $('#wrapper').toggleClass('toggled');
        });
      });
    </script>
    <script type="text/javascript" charset="utf-8">
      $(document).ready(function(){
          var socket = io.connect('http://' + document.domain + ':' + location.port + '/');
          var start_time;
          window.setInterval(function() {
              start_time = (new Date).getTime();
              socket.emit('refresh');
          }, 2000);
          var gauges = {}
          socket.on('refresh', function(msg) {
            for (data in msg.data) {
              var gaugeData = [
                `<div id="${msg.data[data].mac}" class="canvas">`,
                `	<canvas id="${msg.data[data].mac}-canvas-preview"></canvas>`,
                `	<div id="${msg.data[data].mac}-preview-textfield" class="preview-textfield"></div>`,
                `	<div id="${msg.data[data].mac}-preview-datafield" class="preview-datafield"></div>`,
                '</div>',
              ].join("\n");
              if(
                $('#container').find(`[id*="${msg.data[data].mac}"]`).length == 0
              ) {
                $('#container').append(gaugeData);
                var target = document.getElementById(`${msg.data[data].mac}-canvas-preview`);
                var gauge = new Gauge(target).setOptions({
                  angle: 0, // The span of the gauge arc
                  lineWidth: 0.34, // The line thickness
                  radiusScale: 1, // Relative radius
                  pointer: { //disable
                    length: 0,
                    strokeWidth: 0,
                  },
                  colorStart: msg.data[data].color,
                  highDpiSupport: true,
                });
                gauge.maxValue = 1.08; // set max gauge value
                gauge.setMinValue(1.00);  // Prefer setter over gauge.minValue = 0
                gauges[msg.data[data].mac] = gauge
              }

              gauges[msg.data[data].mac].set(msg.data[data].gravity); // set actual value
              document.getElementById(`${msg.data[data].mac}-preview-textfield`).innerHTML = msg.data[data].color + '(' + msg.data[data].mac + ')';
              document.getElementById(`${msg.data[data].mac}-preview-datafield`).innerHTML = msg.data[data].gravity + '(' + msg.data[data].temp + '&deg;)';
            };
          });
      });
    </script>
{% endblock %}

{% block body %}

<a class="github-fork-ribbon" href="https://github.com/myoung34/tilty-dashboard" data-ribbon="Fork me on GitHub" title="Fork me on GitHub">Fork me on GitHub</a>

<div class="row">
  <div class="col-md-12">
  <h1>
  	Tilty-Dashboard
  </h1>


  <div id="wrapper">
      <div class="overlay"></div>

      <!-- Sidebar -->
      <nav class="navbar navbar-inverse navbar-fixed-top" id="sidebar-wrapper" role="navigation">
          <ul class="nav sidebar-nav">
              <li class="sidebar-brand">
                <a href="#"><img src="static/logo_50_50.png" /></a>
              </li>
              <li>
                  <a href="/">Home</a>
              </li>
              <li>
                  <a href="/settings">Settings</a>
              </li>
              <li>
                  <a href="https://marcyoung.us">About</a>
              </li>
          </ul>
      </nav>
      <!-- /#sidebar-wrapper -->

      <!-- Page Content -->
      <div id="page-content-wrapper">
          <button type="button" class="hamburger is-closed" data-toggle="offcanvas">
              <span class="hamb-top"></span>
  			      <span class="hamb-middle"></span>
  		        <span class="hamb-bottom"></span>
          </button>
      {% block content %}
      {% endblock %}
        </div>
    </div>
  </div>
</div>
<div id="footer">
	<p>Copyright 2020&#169; <a href="https://marcyoung.us">Marc Young</a></p>
</div>
{% endblock %}
